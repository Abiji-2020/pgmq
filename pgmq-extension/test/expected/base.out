CREATE EXTENSION
CREATE EXTENSION
 create_unlogged 
-----------------
 
(1 row)

 send 
------
    1
(1 row)

 msg_id | read_ct | ?column? | ?column? |      message       
--------+---------+----------+----------+--------------------
      1 |       1 | f        | t        | {"hello": "world"}
(1 row)

 create 
--------
 
(1 row)

 create 
--------
 
(1 row)

 send 
------
    1
(1 row)

 send 
------
    2
(1 row)

 send 
------
    3
(1 row)

 send 
------
    4
(1 row)

 msg_id | read_ct |                message                 
--------+---------+----------------------------------------
      1 |       1 | {"type": "A", "content": "Message A1"}
      3 |       1 | {"type": "A", "content": "Message A2"}
(2 rows)

 msg_id | read_ct |                message                 
--------+---------+----------------------------------------
      2 |       1 | {"type": "B", "content": "Message B1"}
      4 |       1 | {"type": "B", "content": "Message B2"}
(2 rows)

 msg_id | read_ct | enqueued_at | vt | message 
--------+---------+-------------+----+---------
(0 rows)

 drop_queue 
------------
 t
(1 row)

 create 
--------
 
(1 row)

 create 
--------
 
(1 row)

 send 
------
    1
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
(0 rows)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 create 
--------
 
(1 row)

 ?column? 
----------
 t
(1 row)

 create_partitioned 
--------------------
 
(1 row)

 create_partitioned 
--------------------
 
(1 row)

     queue_name      | queue_length | newest_msg_age_sec | oldest_msg_age_sec | total_messages 
---------------------+--------------+--------------------+--------------------+----------------
 test_duration_queue |            0 |                    |                    |              0
(1 row)

 drop_queue 
------------
 t
 t
(2 rows)

 drop_queue 
------------
 t
 t
 t
 t
(4 rows)

 queue_name 
------------
(0 rows)

 create 
--------
 
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 archive 
---------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 create 
--------
 
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 create 
--------
 
(1 row)

 send 
------
    1
(1 row)

 send 
------
    2
(1 row)

 send 
------
    3
(1 row)

 send 
------
    4
(1 row)

 send 
------
    5
(1 row)

 purge_queue 
-------------
           5
(1 row)

 ?column? 
----------
 t
(1 row)

 create 
--------
 
(1 row)

 msg_id | read_ct | enqueued_at | vt | message 
--------+---------+-------------+----+---------
(0 rows)

 send 
------
    2
(1 row)

 send 
------
    3
(1 row)

 ?column? 
----------
 t
(1 row)

 create 
--------
 
(1 row)

 msg_id | read_ct | enqueued_at | vt | message 
--------+---------+-------------+----+---------
(0 rows)

 msg_id 
--------
      1
(1 row)

 msg_id 
--------
(0 rows)

 msg_id 
--------
      1
(1 row)

 msg_id 
--------
      1
(1 row)

DROP EXTENSION
CREATE EXTENSION
 create_partitioned 
--------------------
 
(1 row)

       queue_name       
------------------------
 test_partitioned_queue
(1 row)

 ?column? 
----------
 t
(1 row)

 delete 
--------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

 ?column? 
----------
 t
(1 row)

BEGIN
 create 
--------
 
(1 row)

ROLLBACK
 tablename 
-----------
(0 rows)

 create 
--------
 
(1 row)

DROP EXTENSION
 tablename 
-----------
(0 rows)

CREATE EXTENSION
 create 
--------
 
(1 row)

 detach_archive 
----------------
 
(1 row)

DROP EXTENSION
       tablename        
------------------------
 a_detach_archive_queue
(1 row)

CREATE EXTENSION
 create 
--------
 
(1 row)

 convert_archive_partitioned 
-----------------------------
 
(1 row)

 convert_archive_partitioned 
-----------------------------
 
(1 row)

 create 
--------
 
(1 row)

 create 
--------
 
(1 row)

 convert_archive_partitioned 
-----------------------------
 
(1 row)

 create 
--------
 
(1 row)

 create 
--------
 
(1 row)

 send 
------
    1
(1 row)

 msg_id | read_ct |      message       
--------+---------+--------------------
      1 |       1 | {"hello": "world"}
(1 row)

 archive 
---------
 t
(1 row)

 create 
--------
 
(1 row)

 send 
------
    1
(1 row)

 msg_id | read_ct |      message       
--------+---------+--------------------
      1 |       1 | {"hello": "world"}
(1 row)

 archive 
---------
 t
(1 row)

 create_partitioned 
--------------------
 
(1 row)

 send 
------
    1
(1 row)

 msg_id | read_ct |      message       
--------+---------+--------------------
      1 |       1 | {"hello": "world"}
(1 row)

 archive 
---------
 t
(1 row)

 create_partitioned 
--------------------
 
(1 row)

 send 
------
    1
(1 row)

 msg_id | read_ct |      message       
--------+---------+--------------------
      1 |       1 | {"hello": "world"}
(1 row)

 archive 
---------
 t
(1 row)

 format_table_name 
-------------------
 q_cat
(1 row)

 format_table_name 
-------------------
 a_cat-dog
(1 row)

 format_table_name 
-------------------
 q_cat_dog
(1 row)

DROP EXTENSION
DROP EXTENSION
